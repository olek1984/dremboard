
function bp_like() {
    jQuery(".like, .unlike, .like_blogpost, .unlike_blogpost").unbind('click');
    jQuery(".like, .unlike, .like_blogpost, .unlike_blogpost").click(function() {
        var e = jQuery(this).attr("class"),
            t = jQuery(this).attr("id"),
            f = jQuery(".activity-content #"+t), // origin like;
            d = jQuery(this);
            
            e = e.replace("bp-secondary-action", "").replace(/ +/,' ').trim();
      
        if(f.length == 0)    
            f = jQuery(".rtmedia-list-item #"+t);
        jQuery(this).addClass("loading");

        jQuery.post(ajaxurl, {
            action: "activity_like",
            cookie: encodeURIComponent(document.cookie),
            type: e,
            id: t
        }, function(n) {
            d.fadeOut(50, function() {
                d.html(n).removeClass("loading").fadeIn(50);
                if (f)f.html(n);
            });

            var r, i;
            if (e.indexOf("button like") !== -1) {
                r = t.replace("like", "unlike");
                d.removeClass("like").addClass("unlike").attr("title", bp_like_terms_unlike_message).attr("id", r);
                if(f)f.removeClass("like").addClass("unlike").attr("title", bp_like_terms_unlike_message).attr("id", r);
            } else if (e.indexOf("acomment-reply bp-primary-action like") !== -1) {
                r = t.replace("like", "unlike");
                d.removeClass("like").addClass("unlike").attr("title", bp_like_terms_unlike_message).attr("id", r);
                if(f)f.removeClass("like").addClass("unlike").attr("title", bp_like_terms_unlike_message).attr("id", r);
            } else if (e.indexOf("button like_blogpost") !== -1) {
                r = t.replace("like", "unlike");
                d.removeClass("like_blogpost").addClass("unlike_blogpost").attr("title", bp_like_terms_unlike_message).attr("id", r);
                if(f)f.removeClass("like_blogpost").addClass("unlike_blogpost").attr("title", bp_like_terms_unlike_message).attr("id", r);
            } else if (e.indexOf("button unlike_blogpost") !== -1) {
                r = t.replace("unlike", "like");
                d.removeClass("unlike_blogpost").addClass("like_blogpost").attr("title", bp_like_terms_unlike_message).attr("id", r);
                if(f)f.removeClass("unlike_blogpost").addClass("like_blogpost").attr("title", bp_like_terms_unlike_message).attr("id", r);
            } else if (e.indexOf("acomment-reply bp-primary-action unlike") !== -1) {
                r = t.replace("unlike", "like");
                d.removeClass("unlike").addClass("like").attr("title", bp_like_terms_like_message).attr("id", r);
                if(f)f.removeClass("unlike").addClass("like").attr("title", bp_like_terms_like_message).attr("id", r);
            } else {
                r = t.replace("unlike", "like");
                d.removeClass("unlike").addClass("like").attr("title", bp_like_terms_like_message).attr("id", r);
                if(f)f.removeClass("unlike").addClass("like").attr("title", bp_like_terms_like_message).attr("id", r);
            }
        });
        return false;
    })
}

jQuery(document).ready(bp_like);
jQuery(document).ajaxComplete(bp_like);
jQuery(function() {
    jQuery("#dialog").dialog({
        autoOpen: false,
        show: {
            effect: "blind",
            duration: 1e3
        },
        hide: {
            effect: "explode",
            duration: 1e3
        }
    });
    jQuery("#opener").click(function() {
        jQuery("#dialog").dialog("open")
    })
})